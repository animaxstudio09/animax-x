<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ANIMAX PRO</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- OneSignal -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({ appId: "fdac3928-a2fc-4bc7-9541-cb85ae026409" });
      });
    </script>
    
    <!-- Modern Fonts (Outfit & Orbitron) -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Plyr Video Player -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- FULLSCREEN SEARCH OVERLAY (FIXED & MODERN) -->
    <div id="search-overlay">
        <div class="search-header-box">
            <i class="fas fa-search search-icon-left"></i>
            <input type="text" id="search-input" placeholder="Search anime, movies..." autocomplete="off">
            <i class="fas fa-times search-close-btn" onclick="closeSearch()"></i>
        </div>
        <div class="search-results-title">Search Results</div>
        <div id="search-results" class="search-grid">
            <div class="empty-search">Type something to search...</div>
        </div>
    </div>

    <!-- AUTH SCREEN -->
    <div id="auth-screen" style="display: none;">
        <div class="auth-brand">ANIMAX <span>PRO</span></div>
        <div class="auth-content">
            <h1 class="auth-headline">Unlimited<br><span>Anime & Movies</span></h1>
            <p class="auth-subhead">Watch anywhere. Cancel anytime.</p>

            <div class="auth-card" id="login-form">
                <input type="email" id="email-in" class="custom-input" placeholder="Email Address">
                <input type="password" id="pass-in" class="custom-input" placeholder="Password">
                <button class="btn-primary" onclick="handleAuth('login')">Sign In</button>
                <div class="auth-footer">New to Animax? <span onclick="toggleAuth()">Sign up now</span></div>
            </div>

            <div class="auth-card" id="reg-form" style="display:none;">
                <input type="email" id="remail-in" class="custom-input" placeholder="Email Address">
                <input type="password" id="rpass-in" class="custom-input" placeholder="Create Password">
                <button class="btn-primary" onclick="handleAuth('reg')">Register</button>
                <div class="auth-footer">Already a user? <span onclick="toggleAuth()">Sign In</span></div>
            </div>
        </div>
    </div>

    <!-- MAIN HOME APP -->
    <div id="main-app" class="app-view" style="display: block; padding-top: 0;">
        <!-- Transparent Glass Header -->
        <header class="glass-header">
            <div class="logo">ANIMAX <span>PRO</span></div>
            <div class="header-icon" onclick="openSearch()"><i class="fas fa-search"></i></div>
        </header>

        <!-- Cinematic Hero Banner -->
        <div id="hero-banner" class="hero-container">
            <div class="hero-overlay"></div>
            <div class="hero-content" id="hero-content">
                <!-- Dynamically loaded -->
            </div>
        </div>

        <div id="ad-banner-top" class="ad-container-center" style="margin-top: 20px;"></div>
        
        <!-- Horizontal Scroll Rows (Netflix Style) -->
        <div class="row-container">
            <div class="row-header">
                <h3><i class="fas fa-fire" style="color:#ff4757;"></i> Trending Now</h3>
                <span>See All</span>
            </div>
            <div class="horizontal-scroll" id="trending-row"></div>
        </div>

        <div class="row-container">
            <div class="row-header">
                <h3><i class="fas fa-bolt" style="color:var(--gold);"></i> New Releases</h3>
            </div>
            <div class="horizontal-scroll" id="new-row"></div>
        </div>

        <div class="dev-footer">CRAFTED BY RJ ROCKY</div>
    </div>

    <!-- MOVIE BOX VIEW -->
    <div id="movie-box-view" class="app-view" style="padding-top: 0;">
        <header class="glass-header">
            <div class="logo">MOVIE <span>BOX</span></div>
            <div style="display:flex; gap:15px;">
                <div class="header-icon" onclick="openSearch()"><i class="fas fa-search"></i></div>
                <div class="header-icon" onclick="switchInterface('main')" style="color: #ff4757;"><i class="fas fa-times"></i></div>
            </div>
        </header>
        
        <div id="movie-hero" class="hero-container">
            <div class="hero-overlay"></div>
            <div class="hero-content" id="movie-hero-content"></div>
        </div>

        <div class="row-container">
            <div class="row-header">
                <h3><i class="fas fa-film" style="color:#ff4757;"></i> Blockbuster Movies</h3>
            </div>
            <!-- Grid for movies (since it's a dedicated movie page) -->
            <div class="movie-grid" id="movie-grid"></div>
        </div>
    </div>

    <!-- PLAYER VIEW (ADVANCED) -->
    <div id="player-view">
        <div class="video-wrapper">
            <div class="back-btn-player" onclick="closePlayer()">
                <i class="fas fa-chevron-left"></i>
            </div>
            <video id="main-video" controls playsinline></video>
        </div>

        <div class="player-meta-container">
            <div class="meta-title" id="player-title">Episode Title</div>
            <div class="meta-tags">
                <span class="tag-match">98% Match</span>
                <span class="tag-year">2024</span>
                <span class="tag-hd">HD</span>
                <span id="content-type-badge">Anime</span>
            </div>

            <div class="action-buttons-row">
                <div class="act-btn-large" id="like-btn" onclick="toggleLike()">
                    <i class="fas fa-plus"></i>
                    <span>My List</span>
                </div>
                <div class="act-btn-large" onclick="shareContent()">
                    <i class="fas fa-paper-plane"></i>
                    <span>Share</span>
                </div>
                <div class="act-btn-large">
                    <i class="fas fa-download"></i>
                    <span>Download</span>
                </div>
            </div>

            <div class="resources-section">
                <select id="season-select" onchange="switchSeason(this.value)" class="season-dropdown"></select>
                <div class="ep-grid" id="episode-pill-container"></div>
            </div>

            <div class="tab-header">
                <div class="tab-item active" id="tab-btn-foryou" onclick="switchPlayerTab('foryou')">More Like This</div>
                <div class="tab-item" id="tab-btn-comments" onclick="switchPlayerTab('comments')">Comments</div>
            </div>

            <div id="tab-content-foryou">
                <div class="movie-grid" id="dynamic-rec-grid" style="margin-top: 15px;"></div>
                <div id="ad-banner-player" class="ad-container-center"></div>
            </div>

            <div id="tab-content-comments" style="display: none; padding-top:15px;">
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <input type="text" id="comment-input" class="comment-input" placeholder="Add a comment...">
                    <button class="comment-btn" onclick="postComment()"><i class="fas fa-paper-plane"></i></button>
                </div>
                <div id="comments-list"></div>
            </div>
        </div>
    </div>

    <!-- SHORTS VIEW -->
    <div id="shorts-view" style="display:none;">
        <div class="back-btn-player" style="position:fixed; top:20px; left:20px; z-index:101;" onclick="hideShorts()">
            <i class="fas fa-arrow-left"></i>
        </div>
        <div id="shorts-container"></div>
    </div>

    <!-- PROFILE VIEW -->
    <div id="profile-view" class="app-view" style="padding-top:0;">
        <div class="profile-header-modern">
            <i class="fas fa-cog settings-icon" onclick="auth.signOut()"></i>
            <div class="avatar-modern">
                <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
            </div>
            <h2 id="profile-name">USER</h2>
            <div id="vip-badge" class="vip-badge-modern">FREE PLAN</div>
        </div>

        <div class="profile-body">
            <div class="menu-list">
                <div class="menu-list-item" onclick="switchInterface('movie')">
                    <div class="icon-box" style="background: rgba(255,71,87,0.1); color:#ff4757;"><i class="fas fa-film"></i></div>
                    <span>Movie Box</span>
                    <i class="fas fa-chevron-right arrow"></i>
                </div>
                <div class="menu-list-item" onclick="openHistory()">
                    <div class="icon-box" style="background: rgba(46,213,115,0.1); color:#2ed573;"><i class="fas fa-history"></i></div>
                    <span>Watch History</span>
                    <i class="fas fa-chevron-right arrow"></i>
                </div>
                <div class="menu-list-item" onclick="window.open('https://t.me/animax090', '_blank')">
                    <div class="icon-box" style="background: rgba(0,168,232,0.1); color:#00A8E8;"><i class="fab fa-telegram-plane"></i></div>
                    <span>Join Telegram</span>
                    <i class="fas fa-chevron-right arrow"></i>
                </div>
            </div>

            <div class="premium-box-modern">
                <h3>Upgrade to Premium <i class="fas fa-crown"></i></h3>
                <p>Enjoy ad-free streaming & exclusive VIP servers.</p>
                <input type="text" id="prem-code" placeholder="Enter VIP Code">
                <button onclick="redeemCode()">Redeem Now</button>
                <div class="buy-link" onclick="buyPremium()">Don't have a code? Buy here.</div>
            </div>
        </div>
    </div>

    <!-- HISTORY VIEW -->
    <div id="history-view">
        <div class="history-header">
            <h2>My List & History</h2>
            <i class="fas fa-times" onclick="closeHistory()"></i>
        </div>
        <div id="history-list-container" style="padding: 20px;"></div>
    </div>

    <!-- BOTTOM FLOATING NAVBAR (APPLE/NETFLIX STYLE) -->
    <nav id="main-nav">
        <div class="nav-item active" onclick="switchTab('home')" data-tab="home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </div>
        <div class="nav-item" onclick="showShorts()" data-tab="shorts">
            <i class="fas fa-play"></i>
            <span>Shorts</span>
        </div>
        <div class="nav-item" onclick="switchTab('profile')" data-tab="profile">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </div>
    </nav>

    <!-- External JavaScript -->
    <script src="app.js"></script>
</body>
    </html>
