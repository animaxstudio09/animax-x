<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ANIMAX PREMIUM</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    <meta name="theme-color" content="#050507">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- Push Notification -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({ appId: "fdac3928-a2fc-4bc7-9541-cb85ae026409" });
      });
    </script>
    
    <!-- Modern Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Advanced Video Player (Plyr & HLS.js) -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <!-- External CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- AUTH INTERFACE -->
    <div id="auth-screen" style="display: none;">
        <div class="auth-navbar">
            <div class="auth-brand">ANIMAX <span>PREMIUM</span></div>
        </div>

        <div class="auth-content">
            <h1 class="auth-headline">Stream Your<br>Favorite <span>Anime</span><br>Anywhere</h1>
            <p class="auth-subhead">Join the world's largest anime community for free.</p>

            <div class="auth-card" id="login-form">
                <div class="input-group">
                    <label>Email Address</label>
                    <input type="email" id="email-in" class="custom-input" placeholder="otaku@example.com">
                </div>
                <div class="input-group">
                    <label>Password</label>
                    <input type="password" id="pass-in" class="custom-input" placeholder="••••••••">
                    <span class="forgot-link" onclick="alert('Contact Admin on Telegram')">Forgot password?</span>
                </div>
                <button class="btn-signin" onclick="handleAuth('login')">ENTER WORLD</button>
                <div class="auth-footer">New here? <span onclick="toggleAuth()">Create Account</span></div>
            </div>

            <div class="auth-card" id="reg-form" style="display:none;">
                <div class="input-group">
                    <label>Valid Email</label>
                    <input type="email" id="remail-in" class="custom-input" placeholder="email@domain.com">
                </div>
                <div class="input-group">
                    <label>Strong Password</label>
                    <input type="password" id="rpass-in" class="custom-input" placeholder="••••••••">
                </div>
                <button class="btn-signin" onclick="handleAuth('reg')">REGISTER NOW</button>
                <div class="auth-footer">Already a member? <span onclick="toggleAuth()">Login Now</span></div>
            </div>
        </div>
        <div class="floating-chat" onclick="window.open('https://t.me/animax090', '_blank')"><i class="fab fa-telegram-plane"></i></div>
    </div>

    <!-- LIVE SEARCH OVERLAY -->
    <div id="search-overlay">
        <div class="search-header">
            <div class="search-bar">
                <i class="fas fa-search search-icon-inner"></i>
                <input type="text" id="search-input" placeholder="Search anime or movies..." onkeyup="performSearch()">
            </div>
            <span class="search-close" onclick="closeSearch()"><i class="fas fa-times"></i></span>
        </div>
        <div id="search-results" class="grid-container" style="padding-top:20px;">
            <p style="text-align:center; width:100%; color:var(--text-muted); grid-column: 1 / -1; margin-top: 50px;">Type something to search...</p>
        </div>
    </div>

    <!-- MAIN HOME APP -->
    <div id="main-app" class="app-view" style="display: block;">
        <header>
            <div class="logo">ANIMAX <span>PRO</span></div>
            <div class="header-icon" onclick="openSearch()"><i class="fas fa-search"></i></div>
        </header>

        <div id="banner-slider"></div>
        <div id="ad-banner-top" class="ad-container-center"></div>
        
        <div class="section-title">
            <div class="section-title-text"><i class="fas fa-bolt"></i> New Releases</div>
            <span class="section-link">See All</span>
        </div>
        <div id="anime-grid" class="grid-container"></div>
        <div class="dev-footer">CRAFTED BY RJ ROCKY</div>
    </div>

    <!-- MOVIE BOX -->
    <div id="movie-box-view" class="app-view">
        <header class="movie-header">
            <div class="logo">MOVIE <span>BOX</span></div>
            <div style="display:flex; gap:10px;">
                <div class="header-icon" onclick="openSearch()"><i class="fas fa-search"></i></div>
                <div class="header-icon" onclick="switchInterface('main')" style="background: rgba(255, 71, 87, 0.1); border-color: rgba(255, 71, 87, 0.3); color: #ff4757;"><i class="fas fa-times"></i></div>
            </div>
        </header>
        <div id="movie-banner-slider"></div>
        <div class="section-title">
            <div class="section-title-text" style="color:#ff4757;"><i class="fas fa-film" style="color:#ff4757;"></i> Trending Movies</div>
        </div>
        <div id="movie-grid" class="grid-container"></div>
    </div>

    <!-- SHORTS VIEW -->
    <div id="shorts-view" style="display:none;">
        <div style="position:fixed; top:25px; left:20px; z-index:101; color:#fff;" onclick="hideShorts()">
            <div style="width:40px; height:40px; background:rgba(255,255,255,0.1); backdrop-filter:blur(10px); border-radius:50%; display:flex; justify-content:center; align-items:center;">
                <i class="fas fa-arrow-left"></i>
            </div>
        </div>
        <div id="shorts-container"></div>
        
        <!-- Shorts Comment Modal -->
        <div id="shorts-comments-modal" class="modal-design">
            <div class="modal-header">
                <span>Comments</span>
                <i class="fas fa-times" onclick="document.getElementById('shorts-comments-modal').style.display='none'"></i>
            </div>
            <div id="shorts-comments-list" class="modal-body"></div>
            <div class="modal-footer">
                <input type="text" id="short-comment-in" placeholder="Write a comment...">
                <button onclick="postShortComment()"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <!-- PLAYER VIEW (ADVANCED) -->
    <div id="player-view">
        <div class="video-wrapper">
            <div class="back-btn-player" onclick="closePlayer()">
                <i class="fas fa-chevron-down"></i>
            </div>
            <!-- Plyr Video Element -->
            <video id="main-video" controls playsinline></video>
        </div>

        <div class="player-meta-container">
            <div class="meta-header">
                <div>
                    <div class="meta-title" id="player-title">Episode Title</div>
                    <div class="meta-info">
                        <span style="background:rgba(255,255,255,0.1); padding:3px 8px; border-radius:6px; color:#fff;"><i class="fas fa-tv"></i> <span id="content-type-badge">Anime</span></span>
                        <span><i class="fas fa-star rating-star"></i> 8.9</span>
                        <span>2024</span>
                        <span>Japan</span>
                        <span id="view-count" style="display:none">0</span>
                        <span id="like-count" style="display:none">0</span>
                    </div>
                </div>
            </div>

            <div class="action-buttons-row">
                <div class="act-btn" id="like-btn" onclick="toggleLike()">
                    <i class="fas fa-plus"></i> My List
                </div>
                <div class="act-btn" onclick="shareContent()">
                    <i class="fas fa-share"></i> Share
                </div>
                <div class="act-btn">
                    <i class="fas fa-download"></i> Download
                </div>
            </div>

            <div class="resources-section">
                <div class="res-title">Servers & Seasons <i class="fas fa-sliders-h" style="color:var(--text-muted); font-size:14px;"></i></div>
                <div class="dropdown-row">
                    <select id="season-select" onchange="switchSeason(this.value)" class="custom-drop" style="width:100%;"></select>
                </div>
                <div class="ep-pill-row" id="episode-pill-container"></div>
            </div>

            <div class="tab-header">
                <div class="tab-item active" id="tab-btn-foryou" onclick="switchPlayerTab('foryou')">Up Next</div>
                <div class="tab-item" id="tab-btn-comments" onclick="switchPlayerTab('comments')">Comments</div>
            </div>

            <div id="tab-content-foryou">
                <div class="rec-grid" id="dynamic-rec-grid"></div>
                <div class="buzz-preview" onclick="showShorts()">
                    <div class="buzz-header">
                        <span>BuzzBox Shorts</span>
                        <span>Explore <i class="fas fa-chevron-right" style="font-size:10px; margin-left:3px;"></i></span>
                    </div>
                    <div class="buzz-imgs">
                        <img src="https://via.placeholder.com/150/111/555?text=S1" class="buzz-img">
                        <img src="https://via.placeholder.com/150/111/555?text=S2" class="buzz-img">
                        <div class="buzz-play"><i class="fas fa-play"></i></div>
                    </div>
                </div>
                <div id="ad-banner-player" class="ad-container-center"></div>
            </div>

            <div id="tab-content-comments" style="display: none;">
                <div class="comment-section">
                    <div style="display:flex; gap:10px; margin-bottom:25px;">
                        <input type="text" id="comment-input" placeholder="Add a comment..." style="flex:1; padding:15px; border-radius:12px; border:none; background:rgba(255,255,255,0.05); color:#fff; outline:none; font-family:'Outfit';">
                        <button style="width:50px; border-radius:12px; border:none; background:var(--gold-gradient); color:#000; font-size:16px; cursor:pointer;" onclick="postComment()"><i class="fas fa-paper-plane"></i></button>
                    </div>
                    <div id="comments-list"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- PROFILE VIEW -->
    <div id="profile-view" class="app-view" style="padding-top:0;">
        <div class="profile-bg-header">
            <div style="position:absolute; top:25px; right:25px; width:40px; height:40px; background:rgba(0,0,0,0.3); border-radius:50%; display:flex; justify-content:center; align-items:center; color:var(--text-muted); border:var(--glass-border); cursor:pointer;" onclick="auth.signOut()">
                <i class="fas fa-sign-out-alt"></i>
            </div>
            <div class="royal-avatar-container">
                <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="royal-avatar-img">
            </div>
        </div>

        <div class="royal-info-card">
            <h2 id="profile-name" style="font-family:'Outfit'; font-weight:800; font-size:24px; color:#fff;">USER</h2>
            <div id="vip-badge" class="royal-badge">FREE ACCOUNT</div>
        </div>

        <div style="margin-top: 30px;">
            <div class="telegram-card" onclick="window.open('https://t.me/animax090', '_blank')">
                <div style="display:flex; align-items:center; gap:15px;">
                    <div style="width:45px; height:45px; background:rgba(255,255,255,0.2); border-radius:12px; display:flex; justify-content:center; align-items:center;">
                        <i class="fab fa-telegram-plane" style="font-size:24px; color:#fff;"></i>
                    </div>
                    <div style="text-align:left;">
                        <h4 style="font-family:'Outfit'; font-weight:700; color:#fff; font-size:15px; margin-bottom:2px;">Join Community</h4>
                        <p style="color:rgba(255,255,255,0.8); font-size:12px; font-weight:400;">Official Updates & Requests</p>
                    </div>
                </div>
                <i class="fas fa-chevron-right" style="color:rgba(255,255,255,0.6);"></i>
            </div>
        </div>

        <div class="menu-grid">
            <div class="royal-menu-btn" onclick="switchInterface('movie')">
                <i class="fas fa-ticket-alt" style="color:#ff4757; text-shadow: 0 0 10px rgba(255,71,87,0.4);"></i>
                <span>Movie Box</span>
            </div>
            <div class="royal-menu-btn" onclick="openHistory()">
                <i class="fas fa-history" style="color:#70a1ff;"></i>
                <span>Watch History</span>
            </div>
            <div class="royal-menu-btn" onclick="alert('Locker Coming Soon!')">
                <i class="fas fa-lock" style="color:#2ed573;"></i>
                <span>VIP Locker</span>
            </div>
            <div class="royal-menu-btn" onclick="document.querySelector('.premium-area').scrollIntoView({behavior:'smooth'})">
                <i class="fas fa-crown" style="color:var(--gold); text-shadow: 0 0 10px rgba(245,208,97,0.4);"></i>
                <span>Get Premium</span>
            </div>
        </div>

        <div class="premium-area">
            <div class="prem-box">
                <div style="position:absolute; top:-30px; right:-30px; width:120px; height:120px; background:radial-gradient(circle, var(--gold) 0%, transparent 70%); opacity:0.15;"></div>
                <h4 style="color:var(--gold); font-family:'Outfit'; font-weight:700; font-size:16px; margin-bottom:18px; display:flex; align-items:center; gap:8px;">
                    <i class="fas fa-gem"></i> Redeem Code
                </h4>
                <input type="text" id="prem-code" placeholder="Enter License Key" style="background:rgba(0,0,0,0.3); border:1px solid rgba(255,255,255,0.1); color:#fff; width:100%; padding:15px; border-radius:12px; margin-bottom:15px; font-family:'Outfit'; font-size:14px; outline:none;">
                <button class="btn-signin" onclick="redeemCode()" style="margin-top:0; padding:14px; font-size:13px; border-radius:12px;">ACTIVATE VIP</button>
                <button onclick="buyPremium()" style="width:100%; background:transparent; border:1px solid rgba(255,255,255,0.1); color:var(--text-muted); padding:14px; margin-top:12px; border-radius:12px; font-size:13px; font-family:'Outfit'; font-weight:600; cursor:pointer;">
                    Purchase Subscription
                </button>
            </div>
        </div>
    </div>

    <!-- HISTORY VIEW -->
    <div id="history-view" style="display:none; position:fixed; inset:0; background:var(--bg-dark); z-index:6000; overflow-y:auto; padding:25px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px; padding-bottom:15px; border-bottom:var(--glass-border);">
            <h2 style="font-family:'Outfit'; font-weight:700; font-size:20px; color:#fff;">Watch History</h2>
            <div style="width:35px; height:35px; background:rgba(255,255,255,0.05); border-radius:50%; display:flex; justify-content:center; align-items:center; cursor:pointer;" onclick="closeHistory()">
                <i class="fas fa-times" style="color:var(--text-muted);"></i>
            </div>
        </div>
        <div id="history-list-container"></div>
    </div>

    <!-- BOTTOM NAVBAR -->
    <nav id="main-nav">
        <i class="fas fa-home active" onclick="switchTab('home')"></i>
        <i class="fas fa-play" onclick="showShorts()"></i>
        <i class="fas fa-user" onclick="switchTab('profile')"></i>
    </nav>

    <!-- External JavaScript -->
    <script src="app.js"></script>
</body>
</html>
